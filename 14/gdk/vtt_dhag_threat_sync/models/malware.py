# -*- coding: utf-8 -*-

from odoo import models, fields, api


class ThreatMalware(models.Model):
    _inherit = 'threat.malware'

    from_last_sync_submit = fields.Integer('Addition From Last Sync', default=0)

    def write(self, vals):
        context = self._context or {}
        if context.get('data_sync'):
            vals.update({
                'submit_count': vals.get('submit_count') + self.from_last_sync_submit,
                'from_last_sync_submit': 0
            })
        return super(ThreatMalware, self).write(vals)

    def extract_sync_data(self, datas, type='push'):
        super(ThreatMalware, self.with_context({'data_sync': 1})).extract_sync_data(datas, type)