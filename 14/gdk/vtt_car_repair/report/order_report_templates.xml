<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="1">
<template id="report_car_repair_order_document">
    <t t-call="web.external_layout">
        <t t-set="doc" t-value="doc.with_context(lang=doc.partner_id.lang)"/>
        <!--For number formatting-->
        <!--<t t-set="doc_lang" t-value="doc.env['res.lang']._lang_get(doc.partner_id.lang)"/>-->
        <h2 class="mt0 mb8" style="text-align: center; font-family: Arial, Helvetica, sans-serif !important;">
            <strong>
                <t t-if="not (env.context.get('proforma', False) or is_pro_forma)">
                    <span t-if="doc.state not in ['draft', 'cancel']">REPAIR ORDER</span>
                    <span t-if="doc.state in ['draft', 'cancel']">QUOTATION</span>
                </t>
            </strong>
            <!--<span t-field="doc.name"/>-->
        </h2>

        <table style="width: 100%; font-family: Arial, Helvetica, sans-serif !important;">
          <tr style="background: transparent;">
            <td style="width: 15%"><strong>Customer</strong>:</td>
            <td colspan="3"><span t-field="doc.partner_id.display_name"/></td>

              <!--Partner with Company separated-->
            <!--<td style="width: 50%"><span t-if="doc.partner_id.parent_id">
              <span t-field="doc.partner_id.parent_id.name"/></span>
            <span t-if="not doc.partner_id.parent_id"><span t-field="doc.partner_id.name"/></span>
            </td>-->

            <!--<td style="width: 15%"></td>
            <td style="width: 20%"></td>-->
          </tr>

            <!--Cc Partner information-->
          <!--<tr>
            <td style="width: 15%"><strong>Cc</strong>:</td>
            <td style="width: 50%"><span t-if="doc.partner_id.parent_id">
              <span t-field="doc.partner_id.name"/><span t-if="doc.partner_id.mobile"> - <span t-field="doc.partner_id.mobile"/></span></span>
            </td>
            <td style="width: 15%"><strong>Mobile</strong>:</td>
            <td style="width: 20%"><span t-field="doc.user_id.mobile"/></td>
          </tr>-->

          <!--Address Information-->
        <tr style="background: transparent;">
            <td style="width: 15%"><strong>Address</strong>:</td>
            <td colspan="3"><span t-if="doc.partner_id.street or doc.partner_id.street2 or doc.partner_id.state_id"><span t-if="doc.partner_id.street"><span t-field="doc.partner_id.street"/></span><span t-if="doc.partner_id.street2">&#44;&#160;<span t-field="doc.partner_id.street2"/></span><span t-if="doc.partner_id.state_id">&#44;&#160;<span t-field="doc.partner_id.state_id.display_name"/></span><span t-if="doc.partner_id.country_id">&#44;&#160;<span t-field="doc.partner_id.country_id.display_name"/></span></span></td>
          </tr>

          <tr style="background: transparent;">
            <td style="width: 15%"><strong>Phone</strong>:</td>
              <td style="width: 45%"><span t-field="doc.partner_id.phone"/></td>
              <!--Partner with Company Phone-->
            <!--<td style="width: 50%"><span t-if="doc.partner_id.parent_id">
              <span t-field="doc.partner_id.parent_id.phone"/></span>
            <span t-if="not doc.partner_id.parent_id"><span t-field="doc.partner_id.phone"/></span></td>-->
            <td style="width: 15%"><strong><t t-esc="doc.company_id.country_id.vat_label or 'Tax ID'"/></strong>:</td>
            <!--<td style="width: 20%"><span t-if="doc.partner_id.parent_id">
              <span t-field="doc.partner_id.parent_id.vat"/></span>
                <span t-if="not doc.partner_id.parent_id"><span t-field="doc.partner_id.vat"/></span></td>-->
              <td style="width: 30%"><span t-field="doc.partner_id.vat"/></td>
          </tr>

          <tr style="background: transparent;">
            <td style="width: 15%"><strong>Model</strong>:</td>
            <td style="width: 45%"><span t-field="doc.vehicle_id.model_id.name"/><span t-if="doc.vehicle_id.model_year">
              model year <span t-field="doc.vehicle_id.model_year"/></span></td>
            <td style="width: 15%"><strong>License Plate</strong>:</td>
            <td style="width: 30%"><span t-field="doc.vehicle_id.license_plate"/></td>
          </tr>

          <tr style="background: transparent;">
            <td style="width: 15%"><strong>Odometer</strong>:</td>
            <td style="width: 45%"><span t-if="doc.odometer"><span t-field="doc.odometer"/></span></td>
              <!--Partner with Company Email-->
            <!--<td style="width: 50%"><span t-if="doc.partner_id.parent_id">
              <span t-field="doc.partner_id.parent_id.email"/></span>
            <span t-if="not doc.partner_id.parent_id"><span t-field="doc.partner_id.email"/></span></td>-->

            <!--<td style="width: 15%"><strong>Expected Date</strong>:</td>
            <td style="width: 30%"><p class="m-0" t-field="doc.dt_deadline" t-options='{"widget": "date"}'/></td>-->

            <td style="width: 15%"><strong>VIN - SN</strong>:</td>
            <td style="width: 30%"><p class="m-0" t-field="doc.vehicle_id.vin_sn"/></td>
          </tr>
        <tr style="background: transparent;">
            <td style="width: 15%"><strong>Ref</strong>:</td>
            <td style="width: 45%"><span t-field="doc.name"/></td>
            <td style="width: 15%"></td>
            <td style="width: 30%"></td>
          </tr>
        </table>

        <p></p>
        <p> </p>

        <div class="page" style="font-family: Arial, Helvetica, sans-serif !important;">
            <div class="oe_structure"/>

            <!-- Is there a discount on at least one line? -->
            <!--<t t-set="display_discount" t-value="any([l.discount for l in doc.order_line])"/>-->

            <table class="table table-sm o_main_table">
                <thead>
                    <tr class="text-center" style="border: 1px solid;">
                        <!-- TODO: remove in master -->
                        <t t-set="colspan" t-value="8"/>
                        <th class="text-center" style="width:3%; border: 1px solid;">STT</th>
                        <!--<th class="text-center" style="width:21%">Name</th>-->
                        <th class="text-center" style="width:33%; border: 1px solid;">DESCRIPTION</th>
                        <th class="text-center" style="width:9%; border: 1px solid;">UOM</th>
                        <th class="text-center" style="width:7%; border: 1px solid;">QUANTITY</th>
                        <th class="text-center" style="width:14%; border: 1px solid;">UNIT PRICE</th>
                        <!--Discount column-->
                        <!--<th t-if="display_discount" style="width:5%" class="text-right" groups="sale.group_discount_per_so_line">
                            <span>Disc.(%)</span>
                            &lt;!&ndash; TODO: remove in master &ndash;&gt;
                            <t t-set="colspan" t-value="colspan+1"/>
                        </th>-->
                        <th style="width:5%; border: 1px solid;" class="text-center">DISC.(%)</th>
                        <!--<th class="text-right" style="width:10%">Taxes</th>-->
                        <th class="text-center" style="width:14%; border: 1px solid;">AMOUNT</th>
                    </tr>
                </thead>
                <tbody class="sale_tbody">

                    <t t-set="current_subtotal" t-value="0"/>
                    <t t-set="r_number" t-value="0"/>

                    <t t-foreach="doc.order_line_ids" t-as="line">

                        <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded"/>
                        <t t-set="current_subtotal" t-value="current_subtotal + line.price_total" groups="account.group_show_line_subtotals_tax_included"/>

                        <t t-set="r_number" t-value="r_number + 1"/>

                        <tr>
                            <t t-if="not line.display_type">
                                <td style="text-align: center; border: 1px solid;"><span t-esc="r_number"/></td>
                                <!--<td><span t-field="line.product_id.name"/></td>-->
                                <td style="border: 1px solid;"><span t-field="line.name"/></td>
                                <td class="text-center" style="border: 1px solid;"><span t-field="line.product_uom" groups="uom.group_uom"/></td>
                                <td class="text-right" style="border: 1px solid;"><span t-field="line.product_uom_qty"/></td>
                                <!--Number Formatting-->
                                <!--<td class="text-right" style="border: 1px solid;"><t t-esc="'{0:,.1f}'.format(line.product_uom_qty).replace(',', '%tmp%').replace('.', doc_lang.decimal_point).replace('%tmp%', doc_lang.thousands_sep)" /></td>-->

                                <td class="text-right" style="border: 1px solid;">
                                    <span t-field="line.price_unit" t-options="{'widget':'monetary', 'display_currency': doc.pricelist_id.currency_id}"/>
                                </td>
                                <!--Discount-->
                                <td class="text-right" style="border: 1px solid;">
                                    <span t-field="line.discount"/>
                                </td>
                                <!--<td class="text-right">
                                    <span t-esc="', '.join(map(lambda x: (x.name or x.description), line.tax_id))"/>
                                </td>-->
                                <td class="text-right o_price_total" style="border: 1px solid;">
                                    <span t-field="line.price_subtotal" t-options="{'widget':'monetary', 'display_currency': doc.pricelist_id.currency_id}"/>
                                </td>
                            </t>
                            <!--Section display-->
                            <t t-if="line.display_type == 'line_section'">
                                <!--<td style="border: 1px solid;" colspan="99">
                                    <strong><span t-field="line.name"/></strong>
                                </td>-->
                                <td style="border: 1px solid;" colspan="6">
                                    <strong><span t-field="line.name"/></strong>
                                </td>
                                <td class="text-right" style="border: 1px solid;">
                                    <span t-esc="current_subtotal" t-options="{'widget': 'monetary', 'display_currency': doc.pricelist_id.currency_id}"/>
                                </td>
                                <t t-set="current_section" t-value="line"/>
                                <t t-set="current_subtotal" t-value="0"/>
                            </t>
                            <t t-if="line.display_type == 'line_note'">
                                <td style="border: 1px solid;" colspan="99">
                                    <i><span t-field="line.name"/></i>
                                </td>
                            </t>
                        </tr>

                        <!--Section display-->
                        <!--<t t-if="current_section and (line_last or doc.order_line_ids[line_index+1].display_type == 'line_section')">
                            <tr class="is-subtotal text-right">
                                <td colspan="99">
                                    <strong class="mr16">Subtotal</strong>
                                    <span t-esc="current_subtotal" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: doc.pricelist_id.currency_id}"/>
                                </td>
                            </tr>
                        </t>-->
                    </t>
                </tbody>
            </table>

            <div class="clearfix">
                <div id="total" class="row" name="total">
                    <div t-attf-class="#{'col-4' if report_type != 'html' else 'col-sm-7 col-md-5'} ml-auto">
                        <table class="table table-sm">
                            <tr class="border-black o_subtotal">
                                <td style="white-space: nowrap;"><strong>Subtotal</strong></td>
                                <td class="text-right">
                                    <span t-field="doc.amount_untaxed" t-options="{'widget':'monetary', 'display_currency': doc.pricelist_id.currency_id}"/>
                                </td>
                            </tr>
                            <t t-foreach="doc.amount_by_group" t-as="amount_by_group">
                                <tr style="white-space: nowrap;">
                                    <t t-if="amount_by_group[3] == 1 and doc.amount_untaxed == amount_by_group[2]">
                                        <td>
                                            <span t-esc="amount_by_group[0]"/>
                                            <span>&amp;nbsp;<span>on</span>&amp;nbsp;<t t-esc="amount_by_group[2]" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: doc.pricelist_id.currency_id}"/></span>
                                        </td>
                                        <td class="text-right o_price_total">
                                            <span t-esc="amount_by_group[1]" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: doc.pricelist_id.currency_id}"/>
                                        </td>
                                    </t>
                                    <t t-else="">
                                        <td>
                                            <span t-esc="amount_by_group[0]"/>
                                        </td>
                                        <td class="text-right o_price_total">
                                            <span t-esc="amount_by_group[1]" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: doc.pricelist_id.currency_id}"/>
                                        </td>
                                    </t>
                                </tr>
                            </t>
                            <tr class="border-black o_total" style="">
                                <td style="white-space: nowrap;"><strong>Total</strong></td>
                                <td class="text-right">
                                    <span t-field="doc.amount_total" t-options="{'widget':'monetary', 'display_currency': doc.pricelist_id.currency_id}"/>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>

            <p><i>Amount Text: <span t-field="doc.amount_total_text"/>.</i> </p>
            <p t-field="doc.quotation_notes"/>
            <p/>

            <table style="width: 100%; font-family: Arial, Helvetica, sans-serif !important;">

              <tr style="background: transparent;">
                <td class="text-center" style="width: 65%;"></td>
                <td class="text-center"><span t-if="doc.company_id.partner_id.state_id">
              <span t-field="doc.company_id.partner_id.state_id.name"/>, </span>Date <span t-esc="doc.dt_receive.strftime('%d')"/> month <span t-esc="doc.dt_receive.strftime('%m')"/> year <span t-esc="doc.dt_receive.strftime('%Y')"/></td>
              </tr>
                <tr style="background: transparent;">
                <td class="text-center" style="width: 65%;"><strong>CUSTOMER</strong></td>
                <td class="text-center"><strong>TECHNICAL</strong></td>
              </tr>
            </table>

            <!--Signature-->
            <!--<div t-if="doc.signature" class="ml16 mr16" name="signature">
                <div class="offset-8">
                    <strong>Signature</strong>
                </div>
                <div class="offset-8">
                    <img t-att-src="image_data_uri(doc.signature)" style="max-height: 4cm; max-width: 8cm;"/>
                </div>
                <div class="offset-8 text-center">
                    <p t-field="doc.signed_by"/>
                </div>
            </div>-->

            <div class="oe_structure"/>
        </div>
    </t>
</template>

<template id="report_car_repair_order_document_sudico">
    <t t-call="web.external_layout">
        <t t-set="doc" t-value="doc.with_context(lang=doc.partner_id.lang)"/>
        <h2 class="mt0 mb8" style="text-align: center; font-family: Arial, Helvetica, sans-serif !important;">
            <strong><t t-if="not (env.context.get('proforma', False) or is_pro_forma)">
                <span t-if="doc.env.context.get('print_state') in ['order']">REPAIR ORDER</span>
                <span t-if="doc.env.context.get('print_state') in ['workorder']">WORK ORDER</span>
                <span t-if="doc.env.context.get('print_state') not in ['order', 'workorder']">QUOTATION</span>
            </t></strong>
            <!--<span t-field="doc.name"/>-->
        </h2>

        <table style="width: 100%; font-family: Arial, Helvetica, sans-serif !important;">
          <tr style="background: transparent;">
            <td style="width: 15%"><strong>Customer</strong>:</td>
            <td colspan="3"><span t-if="doc.env.context.get('print_state') not in ['workorder']"><span t-field="doc.partner_id.display_name"/></span></td>

              <!--Partner with Company separated-->
            <!--<td style="width: 50%"><span t-if="doc.partner_id.parent_id">
              <span t-field="doc.partner_id.parent_id.name"/></span>
            <span t-if="not doc.partner_id.parent_id"><span t-field="doc.partner_id.name"/></span>
            </td>-->

            <!--<td style="width: 15%"></td>
            <td style="width: 20%"></td>-->
          </tr>

            <!--Cc Partner information-->
          <!--<tr>
            <td style="width: 15%"><strong>Cc</strong>:</td>
            <td style="width: 50%"><span t-if="doc.partner_id.parent_id">
              <span t-field="doc.partner_id.name"/><span t-if="doc.partner_id.mobile"> - <span t-field="doc.partner_id.mobile"/></span></span>
            </td>
            <td style="width: 15%"><strong>Mobile</strong>:</td>
            <td style="width: 20%"><span t-field="doc.user_id.mobile"/></td>
          </tr>-->

          <!--Address Information-->
        <tr style="background: transparent;">
            <td style="width: 15%"><strong>Address</strong>:</td>
            <td style="width: 45%"><span t-if="doc.partner_id.street or doc.partner_id.street2 or doc.partner_id.state_id"><span t-if="doc.partner_id.street"><span t-field="doc.partner_id.street"/></span><span t-if="doc.partner_id.street2">, <span t-field="doc.partner_id.street2"/></span><span t-if="doc.partner_id.state_id">, <span t-field="doc.partner_id.state_id.display_name"/></span><span t-if="doc.partner_id.country_id">, <span t-field="doc.partner_id.country_id.display_name"/></span></span></td>
          <td style="width: 15%"><strong>Ref</strong>:</td>
            <td style="width: 30%"><span t-field="doc.name"/></td>
          </tr>

          <tr style="background: transparent;">
            <td style="width: 15%"><strong>Phone</strong>:</td>
              <td style="width: 45%"><span t-if="doc.env.context.get('print_state') not in ['workorder']"><span t-field="doc.partner_id.phone"/></span></td>
              <!--Partner with Company Phone-->
            <!--<td style="width: 50%"><span t-if="doc.partner_id.parent_id">
              <span t-field="doc.partner_id.parent_id.phone"/></span>
            <span t-if="not doc.partner_id.parent_id"><span t-field="doc.partner_id.phone"/></span></td>-->
            <td style="width: 15%"><strong><t t-esc="doc.company_id.country_id.vat_label or 'Tax ID'"/></strong>:</td>
            <!--<td style="width: 20%"><span t-if="doc.partner_id.parent_id">
              <span t-field="doc.partner_id.parent_id.vat"/></span>
                <span t-if="not doc.partner_id.parent_id"><span t-field="doc.partner_id.vat"/></span></td>-->
              <td style="width: 30%"><span t-field="doc.partner_id.vat"/></td>
          </tr>

          <tr style="background: transparent;">
            <td style="width: 15%"><strong>Model</strong>:</td>
            <td style="width: 45%"><span t-field="doc.vehicle_id.model_id"/><span t-if="doc.vehicle_id.model_year">
              model year <span t-field="doc.vehicle_id.model_year"/></span></td>
            <td style="width: 15%"><strong>License Plate</strong>:</td>
            <td style="width: 30%"><span t-field="doc.vehicle_id.license_plate"/></td>
          </tr>

          <tr style="background: transparent;">
            <td style="width: 15%"><strong>Odometer</strong>:</td>
              <td style="width: 45%"><span t-if="doc.odometer"><span t-field="doc.odometer"/></span></td>
              <!--Partner with Company Email-->
            <!--<td style="width: 50%"><span t-if="doc.partner_id.parent_id">
              <span t-field="doc.partner_id.parent_id.email"/></span>
            <span t-if="not doc.partner_id.parent_id"><span t-field="doc.partner_id.email"/></span></td>-->
            <td style="width: 15%"><strong>Expected Date</strong>:</td>
            <td style="width: 30%"><p class="m-0" t-field="doc.dt_deadline" t-options="{&quot;widget&quot;: &quot;date&quot;}"/></td>
          </tr>
        <!--<tr style="background: transparent;">
            <td style="width: 15%"><strong>Ref</strong>:</td>
            <td style="width: 45%"><span t-field="doc.name"/></td>
            <td style="width: 15%"/>
            <td style="width: 30%"/>
          </tr>-->
        </table>

        <p/>
        <p> </p>

        <div class="page" style="font-family: Arial, Helvetica, sans-serif !important;">
            <div class="oe_structure"/>

            <!-- Is there a discount on at least one line? -->
            <!--<t t-set="display_discount" t-value="any([l.discount for l in doc.order_line])"/>-->

            <table class="table table-sm o_main_table">
                <thead>
                    <tr class="text-center" style="border: 1px solid;">
                        <!-- TODO: remove in master -->
                        <t t-set="colspan" t-value="8"/>
                        <th class="text-center" style="width:3%; border: 1px solid;">STT</th>
                        <!--<th class="text-center" style="width:21%">Name</th>-->
                        <th class="text-center" style="width:28%; border: 1px solid;">DESCRIPTION</th>
                        <th class="text-center" style="width:6%; border: 1px solid;">UOM</th>
                        <th class="text-center" style="width:6%; border: 1px solid;">QUANTITY</th>
                        <th class="text-center" style="width:12%; border: 1px solid;">UNIT PRICE</th>
                        <!--Discount column-->
                        <!--<th t-if="display_discount" style="width:5%" class="text-right" groups="sale.group_discount_per_so_line">
                            <span>Disc.(%)</span>
                            &lt;!&ndash; TODO: remove in master &ndash;&gt;
                            <t t-set="colspan" t-value="colspan+1"/>
                        </th>-->
                        <th style="width:9%; border: 1px solid;" class="text-center">DISC.(%)</th>
                        <th class="text-right" style="width:9%; border: 1px solid;">TAXES</th>
                        <th class="text-center" style="width:12%; border: 1px solid;">AMOUNT</th>
                    </tr>
                </thead>
                <tbody class="sale_tbody">

                    <t t-set="current_subtotal" t-value="0"/>
                    <t t-set="r_number" t-value="0"/>
                    <t t-set="total_discount" t-value="0"/>

                    <t t-foreach="doc.order_line_ids" t-as="line">

                        <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded"/>
                        <t t-set="current_subtotal" t-value="current_subtotal + line.price_total" groups="account.group_show_line_subtotals_tax_included"/>

                        <t t-set="r_number" t-value="r_number + 1"/>
                        <!--For show Total discount purpose-->
                        <t t-set="total_discount" t-value="total_discount + (line.amount_reduced * line.product_uom_qty)"/>

                        <tr>
                          <t t-if="not line.display_type">
                            <td style="text-align: center; border: 1px solid;"><span t-esc="r_number"/></td>
                            <!--<td><span t-field="line.product_id.name"/></td>-->
                            <td style="border: 1px solid;"><span t-field="line.name"/></td>
                            <td class="text-center" style="border: 1px solid;"><span t-field="line.product_uom" groups="uom.group_uom"/></td>
                            <td class="text-right" style="border: 1px solid;"><span t-field="line.product_uom_qty"/></td>
                            <td class="text-right" style="border: 1px solid;">
                                <span t-if="doc.env.context.get('print_state') not in ['workorder']" t-field="line.price_unit" t-options='{"widget": "float", "precision": 0}'/>
                                <span t-if="doc.env.context.get('print_state') in ['workorder']">0</span>
                            </td>
                            <!--Discount-->
                            <td class="text-right" style="border: 1px solid;">
                                <!--<span t-field="line.discount"/>-->
                                <!--<span t-field="line.discount_fixed" t-options='{"widget": "float", "precision": 0}'/>-->

                                <!--<span t-if="doc.env.context.get('print_state') not in ['workorder']" t-field="line.amount_reduced" t-options='{"widget": "float", "precision": 0}'/>-->
                                <span t-if="doc.env.context.get('print_state') not in ['workorder']" t-esc="line.amount_reduced * line.product_uom_qty" t-options='{"widget": "float", "precision": 0}'/>
                                <span t-if="doc.env.context.get('print_state') in ['workorder']">0</span>
                            </td>
                            <!--Taxes-->
                            <td class="text-right" style="border: 1px solid;">
                                <span t-esc="', '.join(map(lambda x: (x.name or x.description), line.tax_id))"/>
                            </td>
                            <td class="text-right o_price_total" style="border: 1px solid;">
                                <span t-if="doc.env.context.get('print_state') not in ['workorder']" t-field="line.price_subtotal" t-options='{"widget": "float", "precision": 0}'/>
                                <span t-if="doc.env.context.get('print_state') in ['workorder']">0</span>
                            </td>
                            </t>
                            <!--Section display-->
                            <t t-if="line.display_type == 'line_section'">
                                <!--<td style="border: 1px solid;" colspan="99">
                                    <strong><span t-field="line.name"/></strong>
                                </td>-->
                                <td style="border: 1px solid;" colspan="6">
                                    <strong><span t-field="line.name"/></strong>
                                </td>
                                <td class="text-right" style="border: 1px solid;">
                                    <span t-esc="current_subtotal" t-options="{'widget': 'monetary', 'display_currency': doc.pricelist_id.currency_id}"/>
                                </td>
                                <t t-set="current_section" t-value="line"/>
                                <t t-set="current_subtotal" t-value="0"/>
                            </t>
                            <t t-if="line.display_type == 'line_note'">
                                <td style="border: 1px solid;" colspan="99">
                                    <i><span t-field="line.name"/></i>
                                </td>
                            </t>
                        </tr>

                        <!--Section display-->
                        <!--<t t-if="current_section and (line_last or doc.order_line_ids[line_index+1].display_type == 'line_section')">
                            <tr class="is-subtotal text-right">
                                <td colspan="99">
                                    <strong class="mr16">Subtotal</strong>
                                    <span t-esc="current_subtotal" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: doc.pricelist_id.currency_id}"/>
                                </td>
                            </tr>
                        </t>-->
                    </t>
                </tbody>
            </table>

            <div t-if="doc.env.context.get('print_state') not in ['workorder']" class="clearfix">
                <div id="total" class="row" name="total">
                    <div t-attf-class="#{'col-4' if report_type != 'html' else 'col-sm-7 col-md-5'} ml-auto">
                        <table class="table table-sm">
                            <!--Total Discount-->
                            <tr class="o_subtotal">
                                <td style="white-space: nowrap;">Discount Total</td>
                                <td class="text-right">
                                    <span t-esc="total_discount" t-options='{"widget": "float", "precision": 0}'/>
                                </td>
                            </tr>

                            <!--Subtotal-->
                            <tr class="border-black o_subtotal">
                                <td style="white-space: nowrap;"><strong>Subtotal</strong></td>
                                <td class="text-right">
                                    <span t-field="doc.amount_untaxed" t-options='{"widget": "float", "precision": 0}'/>
                                </td>
                            </tr>

                            <!--Taxes display-->
                            <t t-if="doc.amount_by_group">
                              <t t-foreach="doc.amount_by_group" t-as="amount_by_group">
                                <tr style="white-space: nowrap;">
                                    <t t-if="amount_by_group[3] == 1 and doc.amount_untaxed == amount_by_group[2]">
                                        <td>
                                            <span t-esc="amount_by_group[0]"/>
                                            <span>&amp;nbsp;<span>on</span>&amp;nbsp;<t t-esc="amount_by_group[2]" t-options='{"widget": "float", "precision": 0}'/></span>
                                        </td>
                                        <td class="text-right o_price_total">
                                            <span t-esc="amount_by_group[1]" t-options='{"widget": "float", "precision": 0}'/>
                                        </td>
                                    </t>
                                    <t t-else="">
                                        <td>
                                            <span t-esc="amount_by_group[0]"/>
                                        </td>
                                        <td class="text-right o_price_total">
                                            <span t-esc="amount_by_group[1]" t-options='{"widget": "float", "precision": 0}'/>
                                        </td>
                                    </t>
                                </tr>
                              </t>
                            </t>
                            <t t-if="not doc.amount_by_group">
                              <td>
                                  <span>Thuế GTGT</span>
                              </td>
                              <td class="text-right o_price_total">
                                  <span></span>
                              </td>
                            </t>

                            <tr class="border-black o_total" style="">
                                <td style="white-space: nowrap;"><strong>Total</strong></td>
                                <td class="text-right">
                                    <span t-if="doc.amount_by_group" t-field="doc.amount_total" t-options='{"widget": "float", "precision": 0}'/>
                                    <span t-if="not doc.amount_by_group"></span>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>

            <p t-if="doc.env.context.get('print_state') not in ['workorder']"><i>Amount Text: <span t-field="doc.amount_total_text"/>.</i> </p>
            <p t-if="not doc.amount_by_group and doc.env.context.get('print_state') not in ['workorder']">
              * Giá trên chưa bao gồm thuế giá trị gia tăng.
            </p>
            <p t-if="doc.env.context.get('print_state') in ['order']">
              * Phụ tùng thay thế chính hãng tại gara Sudico được bảo hành 06 tháng hoặc 10.000km tùy theo điều kiện nào đến trước.<br/>
              * Thời gian bảo hành tính từ ngày sửa chữa, lưu ý không áp dụng với các loại lọc và vật liệu hao mòn theo thời gian.<br/>
              * Trả lại toàn bộ vật tư thải loại của xe cho chủ xe.
            </p>
            <p t-field="doc.quotation_notes" t-if="doc.env.context.get('print_state') in ['quotation']"/>
            <p/>

            <table t-if="doc.env.context.get('print_state') not in ['workorder']" style="width: 100%; font-family: Arial, Helvetica, sans-serif !important;">

              <tr style="background: transparent;">
                <td class="text-center" style="width: 65%;"/>
                <td class="text-center"><span t-if="doc.company_id.partner_id.state_id">
              <span t-field="doc.company_id.partner_id.state_id.name"/>, </span>Date <span t-esc="doc.dt_receive.strftime('%d')"/> month <span t-esc="doc.dt_receive.strftime('%m')"/> year <span t-esc="doc.dt_receive.strftime('%Y')"/></td>
              </tr>
                <tr style="background: transparent;">
                <td class="text-center" style="width: 65%;"><strong>CUSTOMER</strong></td>
                <td class="text-center"><strong>TECHNICAL</strong></td>
              </tr>
            </table>

            <!--Signature-->
            <!--<div t-if="doc.signature" class="ml16 mr16" name="signature">
                <div class="offset-8">
                    <strong>Signature</strong>
                </div>
                <div class="offset-8">
                    <img t-att-src="image_data_uri(doc.signature)" style="max-height: 4cm; max-width: 8cm;"/>
                </div>
                <div class="offset-8 text-center">
                    <p t-field="doc.signed_by"/>
                </div>
            </div>-->

            <div class="oe_structure"/>
        </div>
    </t>
</template>
</data>
    <!--Old template-->
<!--<template id="report_car_repair_order_document">
    <t t-call="web.external_layout">
        <t t-set="doc" t-value="doc.with_context(lang=doc.partner_id.lang)"/>
        <h2 class="mt0 mb8" style="font-family: Arial, Helvetica, sans-serif !important;">
            <t t-if="not (env.context.get('proforma', False) or is_pro_forma)">
                <span t-if="doc.state not in ['draft']">Order # </span>
                <span t-if="doc.state in ['draft']">Quotation # </span>
            </t>
            <span t-field="doc.name"/>
        </h2>

        <table style="width: 100%; font-family: Arial, Helvetica, sans-serif !important;">
          <tr>
            <td style="width: 15%"><strong>Customer</strong>:</td>
            <td style="width: 50%"><span t-field="doc.partner_id.display_name"/></td>

              &lt;!&ndash;Partner with Company separated&ndash;&gt;
            &lt;!&ndash;<td style="width: 50%"><span t-if="doc.partner_id.parent_id">
              <span t-field="doc.partner_id.parent_id.name"/></span>
            <span t-if="not doc.partner_id.parent_id"><span t-field="doc.partner_id.name"/></span>
            </td>&ndash;&gt;
            <td style="width: 15%"><strong>Receiver</strong>:</td>
            <td style="width: 20%"><span t-field="doc.receive_user_id"/></td>
          </tr>

            &lt;!&ndash;Cc Partner information&ndash;&gt;
          &lt;!&ndash;<tr>
            <td style="width: 15%"><strong>Cc</strong>:</td>
            <td style="width: 50%"><span t-if="doc.partner_id.parent_id">
              <span t-field="doc.partner_id.name"/><span t-if="doc.partner_id.mobile"> - <span t-field="doc.partner_id.mobile"/></span></span>
            </td>
            <td style="width: 15%"><strong>Mobile</strong>:</td>
            <td style="width: 20%"><span t-field="doc.user_id.mobile"/></td>
          </tr>&ndash;&gt;

          &lt;!&ndash;Address Information&ndash;&gt;
        <tr>
            <td style="width: 15%"><strong>Address</strong>:</td>
            <td style="width: 50%"><span t-if="doc.partner_id.street"><span t-field="doc.partner_id.street"/></span><span t-if="doc.partner_id.street2">&#44;&#160;<span t-field="doc.partner_id.street2"/></span><span t-if="doc.partner_id.state_id">&#44;&#160;<span t-field="doc.partner_id.state_id.display_name"/></span><span t-if="doc.partner_id.country_id">&#44;&#160;<span t-field="doc.partner_id.country_id.display_name"/></span></td>
            <td style="width: 15%"><strong>Mobile</strong>:</td>
            <td style="width: 20%"><span t-field="doc.receive_user_id.mobile"/></td>
          </tr>

          <tr>
            <td style="width: 15%"><strong><t t-esc="doc.company_id.country_id.vat_label or 'Tax ID'"/></strong>:</td>
            <td style="width: 50%"><span t-if="doc.partner_id.parent_id">
              <span t-field="doc.partner_id.parent_id.vat"/></span>
                <span t-if="not doc.partner_id.parent_id"><span t-field="doc.partner_id.vat"/></span></td>
            <td style="width: 15%"><strong><span t-if="doc.dt_confirmed and doc.state not in ['draft']">Date Ordered</span><span t-if="doc.dt_receive and doc.state in ['draft']">Quotation Date</span></strong>:</td>
            <td style="width: 20%">
                <span t-if="doc.state in ['draft']" t-esc="doc.dt_receive.strftime('%d/%m/%Y')"/>
                <span t-if="doc.state not in ['draft']" t-esc="doc.dt_confirmed.strftime('%d/%m/%Y')"/>
            </td>
          </tr>

          <tr>
            <td style="width: 15%"><strong>Email</strong>:</td>
              <td style="width: 50%"><span t-field="doc.partner_id.email"/></td>
              &lt;!&ndash;Partner with Company Email&ndash;&gt;
            &lt;!&ndash;<td style="width: 50%"><span t-if="doc.partner_id.parent_id">
              <span t-field="doc.partner_id.parent_id.email"/></span>
            <span t-if="not doc.partner_id.parent_id"><span t-field="doc.partner_id.email"/></span></td>&ndash;&gt;
            <td style="width: 15%"></td>
            <td style="width: 20%"></td>
          </tr>
          <tr style="background:white;">
            <td style="width: 15%"><strong>Phone</strong>:</td>
              <td style="width: 50%"><span t-field="doc.partner_id.phone"/></td>
              &lt;!&ndash;Partner with Company Phone&ndash;&gt;
            &lt;!&ndash;<td style="width: 50%"><span t-if="doc.partner_id.parent_id">
              <span t-field="doc.partner_id.parent_id.phone"/></span>
            <span t-if="not doc.partner_id.parent_id"><span t-field="doc.partner_id.phone"/></span></td>&ndash;&gt;
            <td style="width: 15%"></td>
            <td style="width: 20%"></td>
          </tr>
        </table>

        <p></p>
        <p> </p>

        <div class="page" style="font-family: Arial, Helvetica, sans-serif !important;">
            <div class="oe_structure"/>

            &lt;!&ndash; Is there a discount on at least one line? &ndash;&gt;
            &lt;!&ndash;<t t-set="display_discount" t-value="any([l.discount for l in doc.order_line])"/>&ndash;&gt;

            <table class="table table-sm o_main_table">
                <thead>
                    <tr>
                        &lt;!&ndash; TODO: remove in master &ndash;&gt;
                        <t t-set="colspan" t-value="8"/>
                        <th class="text-center" style="width:3%">STT</th>
                        <th class="text-center" style="width:21%">Name</th>
                        <th class="text-center" style="width:27%">Description</th>
                        <th class="text-center" style="width:7%">Quantity</th>
                        <th class="text-center" style="width:7%">UoM</th>
                        <th class="text-center" style="width:10%">Unit Price</th>
                        &lt;!&ndash;Discount column&ndash;&gt;
                        &lt;!&ndash;<th t-if="display_discount" style="width:5%" class="text-right" groups="sale.group_discount_per_so_line">
                            <span>Disc.(%)</span>
                            &lt;!&ndash; TODO: remove in master &ndash;&gt;
                            <t t-set="colspan" t-value="colspan+1"/>
                        </th>&ndash;&gt;
                        &lt;!&ndash;<th class="text-right" style="width:10%">Taxes</th>&ndash;&gt;
                        <th class="text-center" style="width:15%">Amount</th>
                    </tr>
                </thead>
                <tbody class="sale_tbody">

                    <t t-set="current_subtotal" t-value="0"/>
                    <t t-set="r_number" t-value="0"/>

                    <t t-foreach="doc.order_line_ids" t-as="line">

                        <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded"/>
                        <t t-set="current_subtotal" t-value="current_subtotal + line.price_total" groups="account.group_show_line_subtotals_tax_included"/>

                        <t t-set="r_number" t-value="r_number + 1"/>

                        <tr>
                            <td style="text-align: center;"><span t-esc="r_number"/></td>
                            <td><span t-field="line.product_id.name"/></td>
                            <td><span t-field="line.name"/></td>
                            <td class="text-right"><span t-field="line.product_uom_qty"/></td>
                            <td class="text-right"><span t-field="line.product_uom" groups="uom.group_uom"/></td>
                            <td class="text-right">
                                <span t-field="line.price_unit" t-options="{'widget':'monetary', 'display_currency': doc.pricelist_id.currency_id}"/>
                            </td>
                            &lt;!&ndash;Discount&ndash;&gt;
                            &lt;!&ndash;<td t-if="display_discount" class="text-right" groups="sale.group_discount_per_so_line">
                                <span t-field="line.discount"/>
                            </td>&ndash;&gt;
                            &lt;!&ndash;<td class="text-right">
                                <span t-esc="', '.join(map(lambda x: (x.name or x.description), line.tax_id))"/>
                            </td>&ndash;&gt;
                            <td class="text-right o_price_total">
                                <span t-field="line.price_subtotal" t-options="{'widget':'monetary', 'display_currency': doc.pricelist_id.currency_id}"/>
                            </td>
                            &lt;!&ndash;Section display&ndash;&gt;
                            &lt;!&ndash;<t t-if="line.display_type == 'line_section'">
                                <td colspan="99">
                                    <span t-field="line.name"/>
                                </td>
                                <t t-set="current_section" t-value="line"/>
                                <t t-set="current_subtotal" t-value="0"/>
                            </t>
                            <t t-if="line.display_type == 'line_note'">
                                <td colspan="99">
                                    <span t-field="line.name"/>
                                </td>
                            </t>&ndash;&gt;
                        </tr>

                        &lt;!&ndash;Section display&ndash;&gt;
                        &lt;!&ndash;<t t-if="current_section and (line_last or doc.order_line[line_index+1].display_type == 'line_section')">
                            <tr class="is-subtotal text-right">
                                <td colspan="99">
                                    <strong class="mr16">Subtotal</strong>
                                    <span t-esc="current_subtotal" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: doc.pricelist_id.currency_id}"/>
                                </td>
                            </tr>
                        </t>&ndash;&gt;
                    </t>
                </tbody>
            </table>

            <div class="clearfix">
                <div id="total" class="row" name="total" style="margin-right:12px;">
                    <div t-attf-class="#{'col-4' if report_type != 'html' else 'col-sm-7 col-md-5'} ml-auto">
                        <table class="table table-sm">
                            <tr class="border-black o_subtotal">
                                <td style="white-space: nowrap;"><strong>Subtotal</strong></td>
                                <td class="text-right">
                                    <span t-field="doc.amount_untaxed" t-options="{'widget':'monetary', 'display_currency': doc.pricelist_id.currency_id}"/>
                                </td>
                            </tr>
                            <t t-foreach="doc.amount_by_group" t-as="amount_by_group">
                                <tr style="white-space: nowrap;">
                                    <t t-if="amount_by_group[3] == 1 and doc.amount_untaxed == amount_by_group[2]">
                                        <td>
                                            <span t-esc="amount_by_group[0]"/>
                                            <span>&amp;nbsp;<span>on</span>&amp;nbsp;<t t-esc="amount_by_group[2]" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: doc.pricelist_id.currency_id}"/></span>
                                        </td>
                                        <td class="text-right o_price_total">
                                            <span t-esc="amount_by_group[1]" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: doc.pricelist_id.currency_id}"/>
                                        </td>
                                    </t>
                                    <t t-else="">
                                        <td>
                                            <span t-esc="amount_by_group[0]"/>
                                        </td>
                                        <td class="text-right o_price_total">
                                            <span t-esc="amount_by_group[1]" t-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: doc.pricelist_id.currency_id}"/>
                                        </td>
                                    </t>
                                </tr>
                            </t>
                            <tr class="border-black o_total" style="">
                                <td style="white-space: nowrap;"><strong>Total</strong></td>
                                <td class="text-right">
                                    <span t-field="doc.amount_total" t-options="{'widget':'monetary', 'display_currency': doc.pricelist_id.currency_id}"/>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>

            <p t-field="doc.quotation_notes"/>

            &lt;!&ndash;Signature&ndash;&gt;
            &lt;!&ndash;<div t-if="doc.signature" class="ml16 mr16" name="signature">
                <div class="offset-8">
                    <strong>Signature</strong>
                </div>
                <div class="offset-8">
                    <img t-att-src="image_data_uri(doc.signature)" style="max-height: 4cm; max-width: 8cm;"/>
                </div>
                <div class="offset-8 text-center">
                    <p t-field="doc.signed_by"/>
                </div>
            </div>&ndash;&gt;

            <div class="oe_structure"/>
        </div>
    </t>
</template>-->

<!--Order print-->
<template id="report_car_repair_order">
    <t t-call="web.html_container">
        <t t-foreach="docs" t-as="doc">
            <t t-set="doc" t-value="doc.with_context(print_state='order')"/>
            <t t-call="vtt_car_repair.report_car_repair_order_document" t-lang="doc.partner_id.lang"/>
        </t>
    </t>
</template>

    <!--Quotation print-->
<template id="report_car_repair_quotation">
    <t t-call="web.html_container">
        <t t-foreach="docs" t-as="doc">
            <t t-set="doc" t-value="doc.with_context(print_state='quotation')"/>
            <t t-call="vtt_car_repair.report_car_repair_order_document" t-lang="doc.partner_id.lang"/>
        </t>
    </t>
</template>

    <!--Workorder print-->
<template id="report_car_repair_workorder">
    <t t-call="web.html_container">
        <t t-foreach="docs" t-as="doc">
            <t t-set="doc" t-value="doc.with_context(print_state='workorder')"/>
            <t t-call="vtt_car_repair.report_car_repair_order_document" t-lang="doc.partner_id.lang"/>
        </t>
    </t>
</template>

</odoo>
