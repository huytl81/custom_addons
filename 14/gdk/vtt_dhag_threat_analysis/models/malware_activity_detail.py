# -*- coding: utf-8 -*-

from odoo import models, fields, api
from . import analysis_tools


class MalwareActivityDetail(models.Model):
    _name = 'threat.malware.activity.detail'
    _description = 'Malware Activity Detail'
    _inherit = ['threat.sync.mixin']

    malware_id = fields.Many2one('threat.malware', string='Malware Reference', index=True)
    # investigate_id = fields.Many2one('investigate.investigate', string='Investigate Reference')
    investigate_ids = fields.Many2many('investigate.investigate', 'investigate_threat_activity_detail_rel', string='Investigate Reference')

    investigate_malware_id = fields.Many2one('investigate.malware', 'Malware')

    activity_type_id = fields.Many2one('threat.malware.activity.type', 'Activity Type')
    activity_id = fields.Many2one('threat.malware.activity', string='Activity Reference')

    @api.onchange('investigate_malware_id')
    def onchange_investigate_malware_id(self):
        if self.investigate_malware_id:
            self.malware_id = self.investigate_malware_id.malware_id.id

    @api.onchange('activity_id')
    def onchange_activity_id(self):
        if self.activity_id:
            self.activity_type_id = self.activity_id.activity_type

    name = fields.Char('Name')
    description = fields.Text('Description')

    ss_code = fields.Char('Secret Sequence', copy=False)

